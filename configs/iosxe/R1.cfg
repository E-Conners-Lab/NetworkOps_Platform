version 17.13
service tcp-keepalives-in
service tcp-keepalives-out
service timestamps debug datetime msec localtime show-timezone
service timestamps log datetime msec localtime show-timezone
service password-encryption
platform qfp utilization monitor load 80
platform punt-keepalive disable-kernel-core
platform sslvpn use-pd
platform console serial
!
hostname R1
!
boot-start-marker
boot-end-marker
!
!
vrf definition CUSTOMER-A
 rd 65000:1
 !
 address-family ipv4
  route-target export 65000:1
  route-target import 65000:1
 exit-address-family
!
logging buffered 16384 informational
no logging console
no logging monitor
aaa new-model
!
!
aaa authentication login default local
aaa authorization exec default local
!
!
aaa session-id common
clock timezone EST -5 0
clock summer-time EDT recurring
!
!
!
!
!
!
ip multicast-routing distributed
!
!
!
!
!
!
ip host r1.mcp.lab 1.1.1.1
ip host r2.mcp.lab 2.2.2.2
ip host r3.mcp.lab 3.3.3.3
ip host r4.mcp.lab 4.4.4.4
ip host r1 1.1.1.1
ip host r2 2.2.2.2
ip host r3 3.3.3.3
ip host r4 4.4.4.4
ip name-server 8.8.8.8 8.8.4.4
ip domain name mcp.lab
ip dhcp excluded-address 10.1.0.1 10.1.0.10
ip dhcp excluded-address 10.255.255.1 10.255.255.32
ip dhcp excluded-address 10.255.255.40 10.255.255.254
!
ip dhcp pool LAN1
 network 10.1.0.0 255.255.255.0
 default-router 10.1.0.1
 dns-server 1.1.1.1 8.8.8.8
 domain-name mcp.lab
 lease 7
!
ip dhcp pool LAB-ZTP
 network 10.255.255.0 255.255.255.0
 default-router 10.255.255.1
 dns-server 8.8.8.8
 option 67 ascii http://203.0.113.65:8080/ztp_base.cfg
 domain-name lab.local
 lease 0 2
!
!
!
login on-failure log
login on-success log
!
!
subscriber templating
ipv6 unicast-routing
!
!
!
!
!
!
!
!
!
!
!
!
pae
!
!
crypto pki trustpoint TP-self-signed-2932251338
 enrollment selfsigned
 subject-name cn=IOS-Self-Signed-Certificate-2932251338
 revocation-check none
 rsakeypair TP-self-signed-2932251338
 hash sha256
!
crypto pki trustpoint SLA-TrustPoint
 enrollment pkcs12
 revocation-check crl
 hash sha256
!
crypto pki trustpoint TP-self-signed-495516812
 enrollment selfsigned
 subject-name cn=IOS-Self-Signed-Certificate-495516812
 revocation-check none
 rsakeypair TP-self-signed-495516812
 hash sha256
!
!
crypto pki certificate chain TP-self-signed-2932251338
 certificate self-signed 01
  30820330 30820218 A0030201 02020101 300D0609 2A864886 F70D0101 0B050030
  31312F30 2D060355 04030C26 494F532D 53656C66 2D536967 6E65642D 43657274
  69666963 6174652D 32393332 32353133 3338301E 170D3235 31323239 30373133
  33375A17 0D333531 32323930 37313333 375A3031 312F302D 06035504 030C2649
  4F532D53 656C662D 5369676E 65642D43 65727469 66696361 74652D32 39333232
  35313333 38308201 22300D06 092A8648 86F70D01 01010500 0382010F 00308201
  0A028201 0100D177 E48601E2 C6FCE1FF B32D915F AB77457A 5F5ACE4F 60DC5D85
  96757F3A A38113B3 F114672B 8A63B907 9BD44051 C1AD4510 C6E042CE EB09A6F9
  405802D7 13095BA7 0A6F8C58 0A223099 8D512691 0D4510E5 F36603C3 FD3A764A
  86AADA50 0AB666B4 A906B9AD 29B01953 3EB4F26D ED899585 A9E6B05B 5A6733F8
  A482EAF6 BC458B71 3B65FCB6 B5EA17B8 62926DFA 18042F98 2C9325AC 1CA7B784
  76733581 44123839 7A8ED179 8E2B1CB8 98755564 E87DD1AA B8CCCC1C 96F80678
  261011E5 FBE2B855 63EBF6D1 95486352 19A26918 4F736828 D91CE4C9 7EC12E27
  A1ED7B4E D3C42A01 89DAD425 FBEF9984 12E31F0E B3EE707E 93DAB10F 1277D9E9
  EDBBADA1 C0E90203 010001A3 53305130 1D060355 1D0E0416 04142B8C 9FAD9A70
  4BD8EC12 CD2F7205 CDF708EC 5C62301F 0603551D 23041830 1680142B 8C9FAD9A
  704BD8EC 12CD2F72 05CDF708 EC5C6230 0F060355 1D130101 FF040530 030101FF
  300D0609 2A864886 F70D0101 0B050003 82010100 8E280DE7 F9BCAC77 27232C79
  EFA7AB30 9187F36C D0A3BFFA A4B71ABB 95DD34EA D325FAB9 54EC1BC1 164355DF
  39FAA5D9 294474B4 2BB9101C C377ABC5 9B226F65 0415C632 0735D7A5 61D67609
  B158D1AB 910FA31C 625CC388 8B9F7BEA FA0504B6 250BB685 A3B1FEFB 5882AFFB
  133CD89D 22D8D94A E31B246F 46157E3B E007AA57 39BB3585 9817044B 3CCB7E01
  77AC932A D473E019 5F0E0587 D02CFA49 D532F150 9725C890 6287A801 D58AA8F2
  82EE09BA 81BD2D35 20F50267 65CCBADA 9E2B27F6 5B5B3583 3F53BF1E BCE9A8A4
  09C9FF0D 7C01B736 1A1D0876 FC3DDE42 292FA0C9 46B88AE6 493E3A05 C9AEC157
  C7A33652 5FB11C83 6F98F538 05EF6259 B1193428
  	quit
crypto pki certificate chain SLA-TrustPoint
 certificate ca 01
  30820321 30820209 A0030201 02020101 300D0609 2A864886 F70D0101 0B050030
  32310E30 0C060355 040A1305 43697363 6F312030 1E060355 04031317 43697363
  6F204C69 63656E73 696E6720 526F6F74 20434130 1E170D31 33303533 30313934
  3834375A 170D3338 30353330 31393438 34375A30 32310E30 0C060355 040A1305
  43697363 6F312030 1E060355 04031317 43697363 6F204C69 63656E73 696E6720
  526F6F74 20434130 82012230 0D06092A 864886F7 0D010101 05000382 010F0030
  82010A02 82010100 A6BCBD96 131E05F7 145EA72C 2CD686E6 17222EA1 F1EFF64D
  CBB4C798 212AA147 C655D8D7 9471380D 8711441E 1AAF071A 9CAE6388 8A38E520
  1C394D78 462EF239 C659F715 B98C0A59 5BBB5CBD 0CFEBEA3 700A8BF7 D8F256EE
  4AA4E80D DB6FD1C9 60B1FD18 FFC69C96 6FA68957 A2617DE7 104FDC5F EA2956AC
  7390A3EB 2B5436AD C847A2C5 DAB553EB 69A9A535 58E9F3E3 C0BD23CF 58BD7188
  68E69491 20F320E7 948E71D7 AE3BCC84 F10684C7 4BC8E00F 539BA42B 42C68BB7
  C7479096 B4CB2D62 EA2F505D C7B062A4 6811D95B E8250FC4 5D5D5FB8 8F27D191
  C55F0D76 61F9A4CD 3D992327 A8BB03BD 4E6D7069 7CBADF8B DF5F4368 95135E44
  DFC7C6CF 04DD7FD1 02030100 01A34230 40300E06 03551D0F 0101FF04 04030201
  06300F06 03551D13 0101FF04 05300301 01FF301D 0603551D 0E041604 1449DC85
  4B3D31E5 1B3E6A17 606AF333 3D3B4C73 E8300D06 092A8648 86F70D01 010B0500
  03820101 00507F24 D3932A66 86025D9F E838AE5C 6D4DF6B0 49631C78 240DA905
  604EDCDE FF4FED2B 77FC460E CD636FDB DD44681E 3A5673AB 9093D3B1 6C9E3D8B
  D98987BF E40CBD9E 1AECA0C2 2189BB5C 8FA85686 CD98B646 5575B146 8DFC66A8
  467A3DF4 4D565700 6ADF0F0D CF835015 3C04FF7C 21E878AC 11BA9CD2 55A9232C
  7CA7B7E6 C1AF74F6 152E99B7 B1FCF9BB E973DE7F 5BDDEB86 C71E3B49 1765308B
  5FB0DA06 B92AFE7F 494E8A9E 07B85737 F3A58BE1 1A48A229 C37C1E69 39F08678
  80DDCD16 D6BACECA EEBC7CF9 8428787B 35202CDC 60E4616A B623CDBD 230E3AFB
  418616A9 4093E049 4D10AB75 27E86F73 932E35B5 8862FDAE 0275156F 719BB2F0
  D697DF7F 28
  	quit
crypto pki certificate chain TP-self-signed-495516812
!
!
!
!
!
!
!
!
!
license udi pid C8000V sn XXXXXXXXXXXX
license boot level network-advantage addon dna-advantage
memory free low-watermark processor 225161
diagnostic bootup level minimal
!
!
spanning-tree extend system-id
!
!
enable secret 9 $9$REDACTED
!
username admin privilege 15 secret 9 $9$REDACTED
username readonly secret 9 $9$REDACTED
!
redundancy
bfd-template single-hop BFD-OSPF
 interval min-tx 100 min-rx 100 multiplier 3
!
!
!
!
!
!
cdp run
!
!
track 1 ip sla 1 reachability
lldp run
!
class-map match-any BULK-DATA
 match dscp af11
 match dscp af12
class-map match-any CRITICAL-DATA
 match dscp af31
 match dscp af32
 match dscp cs3
class-map match-any VIDEO
 match dscp af41
 match dscp af42
 match dscp cs4
class-map match-any VOICE
 match dscp ef
 match dscp cs5
!
policy-map WAN-EGRESS
 class VOICE
  priority percent 10
 class VIDEO
  bandwidth percent 20
 class CRITICAL-DATA
  bandwidth percent 25
 class BULK-DATA
  bandwidth percent 15
  fair-queue
 class class-default
  bandwidth percent 30
  fair-queue
policy-map WAN-SHAPE
 class class-default
  shape average 100000000
  service-policy WAN-EGRESS
!
interface Loopback0
 description Updated by NOC team
 ip address 198.51.100.1 255.255.255.255
 ip pim sparse-mode
 ip nat inside
 ip igmp version 3
 ip ospf network point-to-point
 ipv6 address 2001:DB8::1/128
 ospfv3 1 ipv6 area 0
!
interface Loopback100
 vrf forwarding CUSTOMER-A
 ip address 10.100.1.1 255.255.255.255
!
interface Loopback300
 no ip address
!
interface Tunnel100
 description DMVPN-HUB
 ip address 172.16.0.1 255.255.255.0
 no ip redirects
 ip pim sparse-mode
 ip nhrp network-id 100
 ip nhrp redirect
 ipv6 address 2001:DB8:100::1/64
 ipv6 nhrp network-id 100
 ipv6 nhrp redirect
 tunnel source Loopback0
 tunnel mode gre multipoint
 tunnel key 100
!
interface GigabitEthernet1
 ip address 10.0.12.1 255.255.255.252
 ip pim sparse-mode
 ip nat inside
 ip ospf network point-to-point
 negotiation auto
 cdp enable
 ipv6 address 2001:DB8:12::1/64
 ospfv3 network point-to-point
 ospfv3 1 ipv6 area 0
 bfd template BFD-OSPF
 no mop enabled
 no mop sysid
!
interface GigabitEthernet2
 ip address 10.0.13.1 255.255.255.252
 ip pim sparse-mode
 ip nat inside
 ip ospf network point-to-point
 negotiation auto
 cdp enable
 ipv6 address 2001:DB8:13::1/64
 ospfv3 network point-to-point
 ospfv3 1 ipv6 area 0
 bfd template BFD-OSPF
 no mop enabled
 no mop sysid
!
interface GigabitEthernet3
 description LAN-Segment-Updated
 no ip address
 ip pim sparse-mode
 ip nat inside
 ip igmp version 3
 shutdown
 negotiation auto
 cdp enable
 ipv6 address 2001:DB8:1::1/64
 no mop enabled
 no mop sysid
!
interface GigabitEthernet4
 description Management Interface
 ip address 10.255.255.11 255.255.255.0
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet5
 description UNUSED - DISABLED
 no ip address
 shutdown
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet6
 description Docker-1-Direct
 ip address 10.1.1.1 255.255.255.0
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet7
 description Switch-R1
 ip address 10.1.0.1 255.255.255.0
 negotiation auto
 no mop enabled
 no mop sysid
!
router eigrp DMVPN
 !
 address-family ipv4 unicast autonomous-system 100
  !
  af-interface Tunnel100
   no next-hop-self
   no split-horizon
  exit-af-interface
  !
  topology base
  exit-af-topology
  network 10.1.0.0 0.0.0.255
  network 10.1.1.0 0.0.0.255
  network 172.16.0.0 0.0.0.255
 exit-address-family
 !
 address-family ipv6 unicast autonomous-system 100
  !
  af-interface Tunnel100
   no next-hop-self
   no split-horizon
  exit-af-interface
  !
  topology base
  exit-af-topology
 exit-address-family
!
router ospfv3 1
 router-id 198.51.100.1
 !
 address-family ipv6 unicast
 exit-address-family
!
router ospf 1
 router-id 198.51.100.1
 passive-interface GigabitEthernet3
 network 10.0.12.0 0.0.0.3 area 0
 network 10.0.13.0 0.0.0.3 area 0
 network 198.51.100.1 0.0.0.0 area 0
 bfd all-interfaces
!
router bgp 65000
 bgp router-id 198.51.100.1
 bgp log-neighbor-changes
 no bgp default ipv4-unicast
 neighbor IBGP peer-group
 neighbor IBGP remote-as 65000
 neighbor IBGP update-source Loopback0
 neighbor 198.51.100.2 peer-group IBGP
 neighbor 198.51.100.3 peer-group IBGP
 neighbor 198.51.100.4 peer-group IBGP
 !
 address-family ipv4
  neighbor IBGP route-reflector-client
  neighbor 198.51.100.2 activate
  neighbor 198.51.100.3 activate
  neighbor 198.51.100.4 activate
 exit-address-family
 !
 address-family ipv6
  neighbor IBGP route-reflector-client
  neighbor 198.51.100.2 activate
  neighbor 198.51.100.3 activate
  neighbor 198.51.100.4 activate
  network 2001:DB8::1/128
  network 2001:DB8:1::/64
 exit-address-family
 !
!
ip route 0.0.0.0 0.0.0.0 10.255.255.1
ip route 10.100.1.0 255.255.255.0 10.0.13.2 250
ip route 10.100.2.0 255.255.255.0 10.0.13.2 250
ip route 10.200.0.0 255.255.255.252 10.0.13.2 250
ip route 172.20.20.0 255.255.255.0 10.255.255.1
ntp authenticate
ntp source Loopback0
ntp master 3
ntp server 10.255.255.1
ntp server pool.ntp.org
!
ip forward-protocol nd
!
ip pim bsr-candidate Loopback0 30 100
ip pim rp-candidate Loopback0 group-list 10
ip pim ssm default
no ip http server
ip http authentication local
no ip http secure-server
ip http path flash:
ip dns server
ip nat inside source list NAT-INSIDE interface GigabitEthernet4 overload
ip ssh bulk-mode 131072
ip scp server enable
!
!
ip access-list standard NAT-INSIDE
 10 permit 10.0.0.0 0.255.255.255
 20 permit 172.16.0.0 0.0.0.255
ip access-list standard SNMP-ACL
 10 permit 10.255.255.0 0.0.0.255
 20 permit 203.0.113.0 0.0.0.255
 30 deny any log
ip access-list standard VTY-ACL
 10 permit 10.255.255.0 0.0.0.255
 20 permit 203.0.113.0 0.0.0.255
 30 deny any log
!
ip sla 1
 icmp-echo 4.4.4.4 source-ip 1.1.1.1
  frequency 5
ip sla schedule 1 life forever start-time now
logging origin-id hostname
logging source-interface GigabitEthernet4
logging host 203.0.113.57 transport tcp port 5514 session-id hostname
ip access-list standard 10
 10 permit 224.0.0.0 15.255.255.255
 20 permit 239.0.0.0 0.255.255.255
!
!
!
!
!
!
control-plane
!
!
mgcp behavior rsip-range tgcp-only
mgcp behavior comedia-role none
mgcp behavior comedia-check-media-src disable
mgcp behavior comedia-sdp-force disable
!
mgcp profile default
!
!
!
!
!
banner login ^C AUTHORIZED ACCESS ONLY - All activity is monitored and logged ^C
banner motd ^CTest Banner from Change Management^C
!
line con 0
 exec-timeout 0 0
 stopbits 1
line aux 0
 no exec
line vty 0 4
 access-class VTY-ACL in
 exec-timeout 0 0
 transport input ssh
line vty 5 15
 transport input ssh
!
!
!
!
!
!
event manager applet TRACK-DOWN
 event track 1 state down
 action 1.0 syslog msg "IP SLA 1: R4 loopback unreachable"
event manager applet TRACK-UP
 event track 1 state up
 action 1.0 syslog msg "IP SLA 1: R4 loopback reachable"
!
telemetry ietf subscription 100
 encoding encode-kvgpb
 filter xpath /interfaces-ios-xe-oper:interfaces/interface/statistics
 source-address 10.255.255.11
 stream yang-push
 update-policy periodic 5000
 receiver ip address 203.0.113.62 57000 protocol grpc-tcp
telemetry ietf subscription 101
 encoding encode-kvgpb
 filter xpath /process-cpu-ios-xe-oper:cpu-usage/cpu-utilization/five-seconds
 source-address 10.255.255.11
 stream yang-push
 update-policy periodic 5000
 receiver ip address 203.0.113.62 57000 protocol grpc-tcp
telemetry ietf subscription 102
 encoding encode-kvgpb
 filter xpath /memory-ios-xe-oper:memory-statistics/memory-statistic
 source-address 10.255.255.11
 stream yang-push
 update-policy periodic 5000
 receiver ip address 203.0.113.62 57000 protocol grpc-tcp
telemetry ietf subscription 103
 encoding encode-kvgpb
 filter xpath /interfaces-ios-xe-oper:interfaces/interface/oper-status
 stream yang-push
 update-policy on-change
 receiver ip address 203.0.113.62 57000 protocol grpc-tcp
telemetry ietf subscription 104
 encoding encode-kvgpb
 filter xpath /process-cpu-ios-xe-oper:cpu-usage/cpu-utilization/five-seconds
 stream yang-push
 update-policy periodic 10000
 receiver ip address 203.0.113.62 57000 protocol grpc-tcp
telemetry ietf subscription 105
 encoding encode-kvgpb
 filter xpath /memory-ios-xe-oper:memory-statistics/memory-statistic
 stream yang-push
 update-policy periodic 30000
 receiver ip address 203.0.113.62 57000 protocol grpc-tcp
telemetry receiver protocol grpc-tcp
netconf-yang
restconf
end